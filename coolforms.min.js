/*! coolforms 0.2.1 */
(function(){var a;angular.module("CoolFormValidators",[]),angular.module("CoolFormServices",["CoolFormValidators"]),angular.module("CoolFormDirectives",["CoolFormServices"]),angular.module("CoolForm",["CoolFormDirectives","CoolFormServices"]),angular.module("CoolFormDirectives").directive("coolformContainer",function(){var b;return b=function(a){return a.$watch("definition",function(b){return b.pages?b.pages.length>1?a.wizard=!0:a.page=a.definition.pages[0]:void 0})},{restrict:"E",scope:{definition:"=",service:"="},template:a.container,link:b}}),angular.module("CoolForm").directive("coolform",function(b,c){var d;return d=function(a){return null!=a.url?a.definition=b().getJSON(a.url).then(function(b){return a.definition=b.form}):null!=a.form&&(a.definition=a.form.form,console.log(a.form)),a.$watch("form",function(b){return null!=b&&null!=b.form?(a.definition=a.form.form,a.service=c(a.definition)):void 0})},{restrict:"E",scope:{url:"@?",form:"=?"},template:a.controller,link:d,replace:!0}}),angular.module("CoolFormDirectives").directive("coolformField",function(){var b;return b=function(a){var b;return a.error=!1,a.show=!0,b={ok:function(){return a.error=!1},error:function(b){return a.error=b}},a.service.watchField(a.field.name,b),null!=a.field.show_when?a.service.display.showWhen(a.field.show_when,function(b){return a.show=b}):void 0},{restrict:"E",scope:{field:"=",service:"="},template:a.field,link:b}}),angular.module("CoolFormDirectives").directive("coolformHeader",function(){return{restrict:"E",scope:{header:"="},template:a.header}}),angular.module("CoolFormDirectives").directive("coolformLine",function(){var b;return b=function(a){var b,c,d,e,f;for(e=a.fields,f=[],c=0,d=e.length;d>c;c++)b=e[c],b.size?f.push(void 0):f.push(b.size=1);return f},{restrict:"E",scope:{fields:"=",service:"="},template:a.line,link:b}}),angular.module("CoolFormDirectives").directive("coolformPage",function(){return{restrict:"E",scope:{page:"=",service:"="},template:a.page}}),angular.module("CoolFormDirectives").directive("coolformSubmit",function(){var b;return b=function(a){return a.submit=function(){return a.service.submit()},a.reset=function(){return a.service.reset()}},{restrict:"E",scope:{definition:"=",service:"="},template:a.submit,link:b}}),angular.module("CoolFormDirectives").directive("coolformText",function(){var b;return b=function(a){var b,c,d;return b={change:function(b){return a.value!==b?a.value=b:void 0}},d=a.service.registerField(a.field.name,b),a.value=a.field.value?value:"",a.$watch("value",function(a){return d(a)}),c=function(b){return a.type="text",null!=b&&null!=b.password&&b.password===!0?a.type="password":void 0},c(a.field.options)},{restrict:"E",scope:{field:"=",service:"="},template:a.text,link:b}}),angular.module("CoolFormDirectives").directive("coolformWizard",function(){var b;return b=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;for(a.current=0,g=function(b){return a.service.validateFields(f[b])},a.moveTo=function(b){return g(a.current)===!0?a.current=b:void 0},a.moveToNext=function(){return a.moveTo(a.current+1)},a.isCurrent=function(b){return a.current===b?!0:!1},a.isLast=function(){return a.current===a.definition.pages.length-1?!0:!1},a.nextTitle=function(){return a.current+1<a.definition.pages.length?a.definition.pages[a.current+1].title:void 0},a.errorsOnPage=function(b){return!$.isEmptyObject(a.errors[b])},h=function(b,c){var d;return d={ok:function(){return delete a.errors[b][c]},error:function(d){return a.errors[b][c]=d}},a.service.watchField(c,d)},a.errors=[],f=[],d=0,o=a.definition.pages,r=[],i=0,l=o.length;l>i;i++){for(e=o[i],a.errors[d]={},f[d]=[],p=e.lines,j=0,m=p.length;m>j;j++)for(c=p[j],q=c.fields,k=0,n=q.length;n>k;k++)b=q[k],f[d].push(b.name),h(d,b.name);r.push(d+=1)}return r},{restrict:"E",scope:{definition:"=",service:"="},template:a.wizard,link:b}}),angular.module("CoolFormValidators").factory("emailValidator",function(){var a;return a=function(a,b){var c;return null==b[a]||"string"!=typeof b[a]?!1:(c=/^([\w.-]+)@([\w.-]+)\.([a-zA-Z.]{2,6})$/i,null!=b[a]&&b[a].match(c)?!0:!1)},{validator:a,init:null}}),angular.module("CoolFormValidators").factory("exactSizeValidator",function(){var a;return a=function(a,b,c){return null==b[a]||"string"!=typeof b[a]?!1:b[a].length===c.options.size?!0:!1},{validator:a,init:null}}),angular.module("CoolFormValidators").factory("maxSizeValidator",function(){var a;return a=function(a,b,c){return null==b[a]||"string"!=typeof b[a]?!1:b[a].length<=c.options.size?!0:!1},{validator:a,init:null}}),angular.module("CoolFormValidators").factory("minSizeValidator",function(){var a;return a=function(a,b,c){return null==b[a]||"string"!=typeof b[a]?!1:b[a].length>=c.options.size?!0:!1},{validator:a,init:null}}),angular.module("CoolFormValidators").factory("notBlankValidator",function(){var a;return a=function(a,b){var c;return c=b[a],void 0===c||null===c?!1:"boolean"==typeof c&&c===!0||c===!1?!0:"number"==typeof c?!0:"string"==typeof c?c.replace(/^\s+|\s+$/g,"").length>0?!0:!1:!1},{validator:a,init:null}}),angular.module("CoolFormValidators").factory("sameAsValidator",function(){var a,b;return b=function(a,b,c){return b[a]===b[c.options.field]?!0:!1},a=function(a,b,c){return c.watchField(b.options.field,null,null,function(){return c.validateField(a)})},{validator:b,init:a}}),angular.module("CoolFormValidators").factory("validators",function(a,b,c,d,e,f){var g,h,i;return i={email:a,exact_size:b,max_size:c,min_size:d,not_blank:e,same_as:f},h=function(a){return null!=i[a]?i[a]:null},g=function(a,b){return i[a]=b},{get:h,add:g}}),angular.module("CoolFormServices").factory("displayService",function(){return function(a,b){var c,d,e,f,g;return g=function(a,b){var c,d,e;for(d=0,e=b.length;e>d;d++)if(c=b[d],c===a)return!0;return!1},f=function(a){var c,d,e;for(d=0,e=a.length;e>d;d++)if(c=a[d],g(b[c.field],c.values))return!0;return!1},e=function(a){return!f(a)},d=function(b,c,d){var e,f,g,h;for(h=[],f=0,g=b.length;g>f;f++)e=b[f],h.push(a.watchField(e.field,{change:function(){return c(d(b))}}));return h},c={showWhen:function(a,b){return d(a,b,f)},hideWhen:function(a,b){return d(a,b,e)}}}}),angular.module("CoolFormServices").factory("eventService",function(){return function(){var a,b,c,d;return c={ok:{},error:{},change:{}},b=function(a,b,d){var e,f,g,h,i;if(null!=c[b]&&null!=c[b][a]){for(h=c[b][a],i=[],f=0,g=h.length;g>f;f++)e=h[f],null!=d?i.push(e(d)):i.push(e());return i}},d=function(a,b){var d,e;e=[];for(d in b)null!=c[d]?(null==c[d][a]&&(c[d][a]=[]),e.push(c[d][a].push(b[d]))):e.push(void 0);return e},a={handle:b,watchField:d}}}),angular.module("CoolFormServices").factory("networkService",function(a){return function(){var b,c,d;return b=function(b){var c;return c=a.defer(),$.getJSON(b,function(a){return c.resolve(a)}),c.promise},d=function(a,b){var c;return c={type:a.method,url:a.url,contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:b,success:a.success,error:a.error,headers:a.headers},$.ajax(c)},c={getJSON:b,sendForm:d}}}),angular.module("CoolFormServices").factory("registrationService",function(a,b,c,d){return function(e){var f,g,h,i,j,k,l,m,n,o,p;return h=b(),o=a(h),p={},g=d(h,p),m=function(a){var b,c,d,e,f,g,h,i,j,k,m,n,p;for(d=0,p=[],f=0,i=a.length;i>f;f++){for(e=a[f],m=e.lines,g=0,j=m.length;j>g;g++)for(c=m[g],n=c.fields,h=0,k=n.length;k>h;h++)b=n[h],o.initValidation(b,l);p.push(d+=1)}return p},f=function(a,b){return p[a]=b,o.removeError(a),h.handle(a,"change",b)},j=function(a,b){return h.watchField(a,b),function(b){return f(a,b)}},n=function(){var a;if(o.validateAll(p)!==!1)return a={url:e.url,method:null!=e.method?e.method:"POST",success:function(){return console.log("success")},error:function(){return console.log("error")},headers:null!=e.headers?e.headers:{}},c().sendForm(a,p)},i=function(a){var b,c,d,e,f;for(f=[],d=0,e=a.length;e>d;d++)b=a[d],c=angular.injector([b.module]).get(b.factory),"validator"===b.type?f.push(o.add(b.name,c)):f.push(void 0);return f},k=function(){var a,b,c,d,e;for(d=Object.keys(p),e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(f(a,null));return e},l={display:g,registerField:j,validateField:function(a){return o.validateField(a,p)},validateFields:function(a){return o.validateFields(a,p)},validateAll:function(){return o.validateAll(p)},watchField:h.watchField,reset:k,submit:n},null!=e.dependencies&&i(e.dependencies),m(e.pages),l}}),angular.module("CoolFormServices").factory("validationService",function(a){return function(b){var c,d,e,f,g,h,i,j;return c={},d={},f=function(a){return delete c[a],b.handle(a,"ok"),!0},g=function(a,d){return c[a]=d,b.handle(a,"error",d),!1},e=function(b,c){return d[b.name]=b,null!=b.validation?b.validation.map(function(d){var e;return e=a.get(d.validator),null!=e&&null!=e.init?e.init(b.name,d,c):void 0}):void 0},i=function(b,c){var e,h,i,j,k,l;if(e=d[b],null!=e.validation)for(l=e.validation,j=0,k=l.length;k>j;j++)if(h=l[j],i=a.get(h.validator),i&&null!=i.validator&&!i.validator(b,c,h))return g(b,h.options.message);return f(b)},j=function(a,b){var c,d,e,f;for(d=!0,e=0,f=a.length;f>e;e++)c=a[e],i(c,b)||(d=!1);return d},h=function(a){return j(Object.keys(d),a)},{removeError:f,initValidation:e,validateField:i,validateFields:j,validateAll:h,add:function(b,c){return a.add(b,c)}}}}),a={container:'<form>\n  <div class="container-fluid">\n\n<div ng-if="definition.title || definition.description" class="row">\n  <h3 ng-if="definition.title">{{ definition.title }}</h3>\n  <div ng-if="definition.description" class="well well-sm">\n	{{ definition.description }}\n  </div>\n</div>\n\n<coolform-wizard ng-if="wizard" definition="definition" service="service">\n</coolform-wizard>\n\n<div ng-if="page">\n  <coolform-page page="page" service="service"></coolform-page>\n  <div class="row">\n	<coolform-submit definition="definition" service="service">\n	</coolform-submit>\n  </div>\n</div>	\n\n  </div>\n</form>',controller:'<div>\n  <div ng-if="!definition">\n  	loading {{ url }}\n  </div>\n\n  <div ng-if="definition">\n<coolform-container definition="definition" service="service">\n</coolform-container>\n  </div>\n</div>',field:'<div class="form-group" ng-show="show" ng-class="{\'has-error\': error}" >\n\n  <label class="control-label" for="email">\n{{ field.label }}\n  </label>\n  \n  <div class="coolform-popover">\n<ng-switch on="field.type">\n  <coolform-text ng-switch-when="text" field="field" service="service"></coolform-text>\n</ng-switch>\n  </div>\n  \n  <p ng-show="error" class="help-block">{{ error }}</p>\n  <p ng-hide="error" class="help-block" ng-if="field.help">{{ field.help }}</p>\n    \n</div>',header:'<div>\n<h4 class="text-muted">{{ header.title }}</h4>\n<div>{{ header.description }}</div>\n</div>',line:'<div ng-repeat="field in fields">\n  <div class="col-md-{{ field.size * 3 }}" >\n<coolform-field \n   field="field" \n   service="service">\n</coolform-field>\n  </div>\n</div>',page:'<div ng-if="page.title || page.description" class="row">\n<h4 ng-if="page.title" class="text-primary">{{ page.title }}</h4>\n<div ng-if="page.description">{{ page.description }}</div>\n</div>\n\n<div class="row" ng-repeat="line in page.lines">\n<coolform-header ng-if="line.header" header="line.header"></coolform-header>\n<coolform-line \n	 ng-if="line.fields" \n	 fields="line.fields" \n	 service="service">\n</coolform-line>\n</div>',submit:'<div class="well well-sm">\n  <button \n ng-click="submit()" \n type="button" \n class="btn btn-primary">\n{{ definition.submit }}\n  </button>\n  <button \n ng-click="reset()"\n type="button" \n class="btn btn-default">\n{{ definition.reset }}\n  </button>\n</div>',text:'<input \ntype="{{ type }}" \nclass="form-control" \nplaceholder="{{ field.placeholder }}" \nng-model="value"/>',wizard:'<div class="row">\n  <ul class="nav nav-tabs">\n<li ng-repeat="page in definition.pages" ng-class="{active: isCurrent($index)}">\n  <a ng-click="moveTo($index)"\n	 ng-class="{\'text-danger\': errorsOnPage($index)}"\n	 href="">\n	{{ page.title }}\n  </a>\n<li>\n  </ul>\n</div>\n\n<div ng-repeat="page in definition.pages">\n  <coolform-page ng-show="isCurrent($index)" page="page" service="service">\n  </coolform-page>\n</div>\n\n<div ng-hide="isLast()" class="well well-sm">\n  <button ng-click="moveToNext()" \n	  type="button"\n	  class="btn btn-primary"\n	  ng-class="{disabled: errorsOnPage(current)}">\n<span class="glyphicon glyphicon-arrow-right"></span>\n{{ nextTitle() }}\n  </button>\n</div>\n\n<coolform-submit ng-show="isLast()" service="service" definition="definition">\n</coolform-submit>'}}).call(this);