/*! coolforms 0.2.1 */
(function(){var a,b={}.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};angular.module("CoolFormValidators",[]),angular.module("CoolFormServices",["CoolFormValidators"]),angular.module("CoolFormDirectives",["CoolFormServices","ngSanitize"]),angular.module("CoolForm",["CoolFormDirectives","CoolFormServices"]),angular.module("CoolFormDirectives").directive("coolformContainer",function(){var b;return b=function(a){return a.$watch("form",function(b){return b.pages?b.pages.length>1?a.wizard=!0:a.page=a.form.pages[0]:void 0})},{restrict:"E",scope:{form:"="},template:a.container,link:b}}),angular.module("CoolForm").directive("coolform",function(b,c){var d;return d=function(a){return null!=a.url?b().getJSON(a.url).then(function(b){return a.form=c(b)}):null!=a.definition?a.form=c(a.definition):void 0},{restrict:"E",scope:{url:"@?",definition:"=?"},template:a.controller,link:d,replace:!0}}),angular.module("CoolFormDirectives").directive("coolformDynamic",function(a){var b;return b=function(b,c){var d,e;return e=function(a){return"<"+a+' field="field"></'+a+">"},d=a(e(b.field.directive()))(b),c.append(d)},{restrict:"E",scope:{field:"="},template:"",link:b}}),angular.module("CoolFormDirectives").directive("coolformField",function(){var b;return b=function(a){return a.lbl=a.field.label,a.$watch("field.valid",function(b){switch(b){case!0:return a.lbl=a.field.label;case!1:return a.lbl=a.field.error&&""!==a.field.error?a.field.error:a.field.label}})},{restrict:"E",scope:{field:"="},template:a.field,link:b}}),angular.module("CoolFormDirectives").directive("coolformLine",function(){var b;return b=function(){},{restrict:"E",scope:{line:"="},template:a.line,link:b}}),angular.module("CoolFormDirectives").directive("coolformPage",function(){return{restrict:"E",scope:{page:"="},template:a.page}}),angular.module("CoolFormDirectives").directive("coolformSubmit",function(){var b;return b=function(){},{restrict:"E",scope:{form:"="},template:a.submit,link:b}}),angular.module("CoolFormDirectives").directive("coolformText",function(){var b;return b=function(a){return a.value=a.field.value,a.field.onChange.push(function(b){return b!==a.value?a.value=b:void 0}),a.$watch("value",function(b){return a.field.set(b)}),a.type="text",null!=a.field.options.type?a.type=a.field.options.type:void 0},{restrict:"E",scope:{field:"="},template:a.text,link:b}}),angular.module("CoolFormDirectives").directive("coolformWizard",function(){var b;return b=function(a){var b;return a.current=0,b=function(b){return a.service.validateFields(pageFields[b])},a.moveTo=function(b){return b<a.current&&(a.current=b),a.form.pages[a.current].validate()===!0?a.current=b:void 0},a.moveToNext=function(){return a.moveTo(a.current+1)},a.isCurrent=function(b){return a.current===b?!0:!1},a.isLast=function(){var b,c,d,e;if(a.current+1>=a.form.pages.length)return!0;for(b=c=d=a.current+1,e=a.form.pages.length-1;e>=d?e>=c:c>=e;b=e>=d?++c:--c)if(a.form.pages[b].display===!0)return!1;return!0},a.nextTitle=function(){return a.current+1<a.form.pages.length?a.form.pages[a.current+1].title:void 0}},{restrict:"E",scope:{form:"="},template:a.wizard,link:b}}),angular.module("CoolFormValidators").factory("emailValidator",function(){var a;return a=function(a,b){var c;return null==b[a].value||"string"!=typeof b[a].value?!1:(c=/^([\w.-]+)@([\w.-]+)\.([a-zA-Z.]{2,6})$/i,b[a].value.match(c)?!0:!1)},{validator:a,init:null}}),angular.module("CoolFormValidators").factory("exactSizeValidator",function(){var a;return a=function(a,b,c){return null==b[a].value||"string"!=typeof b[a].value?!1:b[a].value.length===c.size?!0:!1},{validator:a,init:null}}),angular.module("CoolFormValidators").factory("maxSizeValidator",function(){var a;return a=function(a,b,c){return null==b[a].value||"string"!=typeof b[a].value?!1:b[a].value.length<=c.size?!0:!1},{validator:a,init:null}}),angular.module("CoolFormValidators").factory("minSizeValidator",function(){var a;return a=function(a,b,c){return null==b[a].value||"string"!=typeof b[a].value?!1:b[a].value.length>=c.size?!0:!1},{validator:a,init:null}}),angular.module("CoolFormValidators").factory("notBlankValidator",function(){var a;return a=function(a,b){var c;return c=b[a].value,void 0===c||null===c?!1:"boolean"==typeof c&&c===!0||c===!1?!0:"number"==typeof c?!0:"string"==typeof c?c.replace(/^\s+|\s+$/g,"").length>0?!0:!1:!1},{validator:a,init:null}}),angular.module("CoolFormValidators").factory("notNullValidator",function(){var a;return a=function(a,b){var c;return c=b[a].value,void 0===c||null===c?!1:!0},{validator:a,init:null}}),angular.module("CoolFormValidators").factory("sameAsValidator",function(){var a,b;return b=function(a,b,c){return b[a].value===b[c.field].value?!0:!1},a=function(a,b,c){return null!=b[c.field]&&b[c.field].onChange,services.watchField(rule.options.field,null,null,function(){return services.validateField(a)})},{validator:b,init:a}}),angular.module("CoolFormValidators").factory("validators",function(a,b,c,d,e,f,g){var h,i,j;return j={email:a,exact_size:b,max_size:c,min_size:d,not_blank:e,not_null:f,same_as:g},i=function(a){return null!=j[a]?j[a]:null},h=function(a){return j[a.name]=angular.injector([a.module]).get(a.factory)},{get:i,add:h}}),angular.module("CoolFormServices").factory("coreService",function(a,b,d){return function(e){var f,g,h,i,j,k,l,m,n,o;return m=b(),o={},g=function(){function a(a){this.subElemName=a}return a.prototype.isValid=function(){var a,b,c,d;for(d=this[this.subElemName],b=0,c=d.length;c>b;b++)if(a=d[b],a.isValid()===!1)return!1;return!0},a.prototype.reset=function(){var a,b,c,d,e;for(d=this[this.subElemName],e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.reset());return e},a.prototype.validate=function(){var a,b,c,d,e;for(b=!0,e=this[this.subElemName],c=0,d=e.length;d>c;c++)a=e[c],a.display===!0&&a.validate()===!1&&(b=!1);return b},a}(),f=function(a){function b(a,c){b.__super__.constructor.call(this,c),this.display=!0,null!=a.show_on&&this._doDisplay(a.show_on,!0),null!=a.hide_on&&this._doDisplay(a.hide_on,!1)}return c(b,a),b.prototype._doDisplay=function(a,b){var c,d,e,f=this;e=[];for(c in a)d=a[c],e.push(o[c].onChange.push(function(a){var c,e,g;for(e=0,g=d.length;g>e;e++)if(c=d[e],a===c)return f.display=b,void 0;return f.display=!b}));return e},b}(g),i=function(b){function e(b){var c,d,f,g,h;if(e.__super__.constructor.call(this,"pages"),this.name=b.name,this.action=b.action,this.method=null==b.method?"POST":b.method,this.submitLabel=b.submit,this.resetLabel=b.reset,this.pages=function(){var a,c,e,f;for(e=b.pages,f=[],a=0,c=e.length;c>a;a++)d=e[a],f.push(new k(d));return f}(),null!=b.dependencies)for(h=b.dependencies,f=0,g=h.length;g>f;f++)switch(c=h[f],c.type){case"validator":a.add(c);break;case"directive":m.add(c.name,c.tag)}}return c(e,b),e.prototype.submit=function(a,b){var c,e,f;if(this.validate()){e={method:this.method,action:this.action,data:{},success:a,error:b},console.log(o);for(c in o)f=o[c],f.display===!0&&(e.data[c]=f.value);return console.log(e),d().sendForm(e)}},e}(g),k=function(a){function b(a){var c;b.__super__.constructor.call(this,a,"lines"),this.title=a.title,this.description=a.description,this.lines=function(){var b,d,e,f;for(e=a.lines,f=[],b=0,d=e.length;d>b;b++)c=e[b],f.push(new j(c));return f}()}return c(b,a),b}(f),j=function(a){function b(a){var c;b.__super__.constructor.call(this,a,"fields"),this.fields=function(){var b,d,e,f;for(e=a.fields,f=[],b=0,d=e.length;d>b;b++)c=e[b],f.push(new h(c));return f}()}return c(b,a),b}(f),h=function(a){function b(a){var c;b.__super__.constructor.call(this,a),this.name=a.name,this.type=a.type,this.label=a.label,this.size=null!=a.size?null!=a.size:1,this.help=a.help,this["default"]=a["default"],this.options=null!=a.options?a.options:{},this.value=this["default"],this.validators=null!=a.validators?function(){var b,d,e,f;for(e=a.validators,f=[],b=0,d=e.length;d>b;b++)c=e[b],f.push(new l(c,this.name));return f}.call(this):[],this.mandatory=this._isMandatory(a),this.error=null,this.valid=!0,this.onChange=[],this.onValidate=[],o[this.name]=this}return c(b,a),b.prototype._isMandatory=function(a){return null!=a.mandatory&&a.mandatory?(this.mandatory=!0,this.validators.push(new l({name:"not_null"},this.name))):!1},b.prototype.isValid=function(){return this.valid},b.prototype._doValidate=function(a,b){var c,d,e,f;for(f=this.onValidate,d=0,e=f.length;e>d;d++)c=f[d],c(a);return this.valid=a,this.error=b,a},b.prototype.set=function(a){var b,c,d,e;if(a!==this.value){for(this.value=a,e=this.onChange,c=0,d=e.length;d>c;c++)b=e[c],b(this.value);return this._doValidate(!0)}},b.prototype.reset=function(){return this.set(this["default"]?this["default"]:null),this._doValidate(!0)},b.prototype.validate=function(){var a,b,c,d;for(d=this.validators,b=0,c=d.length;c>b;b++)if(a=d[b],a.validate()===!1)return this._doValidate(!1,a.message);return this._doValidate(!0)},b.prototype.directive=function(){return m.get(this.type)},b}(f),l=function(){function b(b,c){var d;this.name=b.name,this.message=b.message,this.options=b.options,this.fieldName=c,d=a.get(this.name),d===!0&&null!=d.init&&d.init(this.fieldName,this.options,o)}return b.prototype.validate=function(){var b;return b=a.get(this.name),null===b?!0:b.validator(this.fieldName,o,this.options)},b}(),null!=e.form?(n=new i(e.form),n.reset(),n):null}}),angular.module("CoolFormServices").factory("directivesService",function(){return function(){var a,b,c;return b={text:"coolform-text"},a=function(a,c){return b[a]=c},c=function(a){return b[a]},{get:c,add:a}}}),angular.module("CoolFormServices").factory("networkService",function(a){return function(){var b,c,d;return b=function(b){var c;return c=a.defer(),$.getJSON(b,function(a){return c.resolve(a)}),c.promise},d=function(a){var b;return b={type:a.method,url:a.action,contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:a.data,success:a.success,error:a.error,headers:a.headers},$.ajax(b)},c={getJSON:b,sendForm:d}}}),angular.module("CoolFormServices").factory("validationService",function(a){return function(b){var c,d,e,f,g,h,i,j,k;return c={},d={},f=function(a){return delete c[a],b.handle(a,"ok"),!0},g=function(a,d){return d=null===d?!0:d,c[a]=d,b.handle(a,"error",d),!1},e=function(b,c){return d[b.name]=b,null!=b.validation?b.validation.map(function(d){var e;return e=a.get(d.validator),null!=e&&null!=e.init?e.init(b.name,d,c):void 0}):void 0},k=function(b,c,d){var e,f;return e=null,f=a.get(c.validator),f&&null!=f.validator?f.validator(b,d,c)===!1?(null!=c.options&&null!=c.options.message&&(e=c.options.message),g(b,e)):!0:!0},i=function(a,b){var c,e,g,h,i;if(c=d[a],null!=c.validation)for(i=c.validation,g=0,h=i.length;h>g;g++)if(e=i[g],!k(a,e,b))return!1;return f(a)},j=function(a,b){var c,d,e,f;for(d=!0,e=0,f=a.length;f>e;e++)c=a[e],i(c,b)||(d=!1);return d},h=function(a){return j(Object.keys(d),a)},{removeError:f,initValidation:e,validateField:i,validateFields:j,validateAll:h,add:function(b,c){return a.add(b,c)}}}}),a={container:'<form>\n  <div class="container-fluid">\n\n<coolform-wizard ng-if="wizard" form="form">\n</coolform-wizard>\n\n<div ng-if="page">\n  <coolform-page page="page" service="service"></coolform-page>\n  \n  <coolform-submit form="form"></coolform-submit>	  \n\n</div>	\n\n  </div>\n</form>',controller:'<div>\n  <div ng-if="!form">\n  	loading {{ url }}\n  </div>\n\n  <div ng-if="form">\n<coolform-container form="form">\n</coolform-container>\n  </div>\n</div>',field:'<div class="form-group" \n ng-show="field.display" \n ng-class="{\'has-error\': !field.valid}" >\n\n  <label class="control-label" for="{{ field.name }}">\n{{ field.name }}\n<span ng-if="field.mandatory">*</span>\n  </label>\n\n  <div>\n<coolform-dynamic field="field"></coolform-dynamic>\n  </div>\n\n  <p class="help-block" ng-bind-html="lbl"></p>\n    \n</div>',line:'<div class="row" ng-show="line.display">\n  <div ng-repeat="field in line.fields">\n<div class="col-md-{{ field.size * 3 }}" >\n  <coolform-field field="field"></coolform-field>\n</div>\n  </div>\n</div>',page:'<div ng-if="page.title || page.description" class="row">\n  <div class="col-md-12">\n<h4 ng-if="page.title" class="text-primary">{{ page.title }}</h4>\n<div ng-if="page.description">\n  <div ng-bind-html="page.description"></div>\n</div>\n  </div>\n</div>\n\n<coolform-line ng-repeat="line in page.lines" line="line"></coolform-line>',submit:'<div class="row">\n  <div class="col-md-12">\n<div class="well well-sm">\n  <button \n	 ng-click="form.submit()" \n	 type="button" \n	 class="btn btn-primary">\n	{{ form.submitLabel }}\n  </button>\n  <button \n	 ng-if="form.resetLabel"\n	 ng-click="form.reset()"\n	 type="button" \n	 class="btn btn-default">\n	{{ form.resetLabel }}\n  </button>\n</div>\n  </div>\n</div>',text:'<input \ntype="{{ type }}" \nclass="form-control" \nplaceholder="{{ field.placeholder }}" \nng-model="value"/>',wizard:'<div class="row">\n  <div class="col-md-12">\n<ul class="nav nav-tabs">\n  <li ng-repeat="page in form.pages"\n	  ng-show="page.display"\n	  ng-class="{active: isCurrent($index)}">\n	<a ng-click="moveTo($index)"\n	   ng-class="{\'text-danger\': !form.pages[$index].isValid()}"\n	   href="">\n	  {{ page.title }}\n	</a>\n  <li>\n</ul>\n  </div>\n</div>\n\n<div ng-repeat="page in form.pages">\n  <coolform-page ng-show="isCurrent($index)" page="page"></coolform-page>\n</div>\n\n<div ng-hide="isLast()" class="row">\n  <div class="col-md-12">\n<div  class="well well-sm">\n  <button ng-click="moveToNext()" \n		  type="button"\n		  class="btn btn-primary"\n		  ng-class="{\'btn-danger\': !form.pages[current].isValid()}">\n	<span class="glyphicon glyphicon-arrow-right"></span>\n	{{ nextTitle() }}\n  </button>\n  \n</div>\n  </div>\n</div>\n\n<coolform-submit ng-show="isLast()" form="form"></coolform-submit>'}}).call(this);